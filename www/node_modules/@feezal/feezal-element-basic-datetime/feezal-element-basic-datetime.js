import {FeezalElement, html} from "@feezal/feezal-element";

class FeezalElementBasicDatetime extends FeezalElement {
    static get template() {
        return html`
            <style include="feezal-style-element"></style>
            <div>
                <span id="prefix">[[prefix]]</span>
                <span id="value">[[formatedValue]]</span>
                <span id="suffix">[[suffix]]</span>
            </div>
        `;
    }
    static get properties() {
        return {
            subscribeTopic: {
                type: String,
                value: '',
                reflectToAttribute: true,
            },
            value: {
                type: Number,
                reflectToAttribute: true,
                observer: '_valueChanged'
            },
            decimalSeparator: {
                type: String,
                reflectToAttribute: true,
                value: '.'
            },
            digits: {
                type: Number,
                reflectToAttribute: true,
            },
            prefix: {
                type: String,
                value: '',
                reflectToAttribute: true
            },
            suffix: {
                type: String,
                value: '',
                reflectToAttribute: true
            }


        }
    }


    static get feezal() {
        return {
            palette: {
                category: 'Basic',
                name: 'Number',
                color: '#eee'
            },
            attributes: [
                'digits',
                'decimalSeparator',
                'prefix',
                'suffix'

            ],
            baseAttribute: 'value',
            styles: [
                'top',
                'left',
                'width',
                'height',
                'font',
                'color',
                'text-align',
                'background',
                'border',
                'overflow',
            ],
            restrict: {
                minWidth: 36,
                minHeight: 12
            },
            defaultStyle: {
                width: '60px',
                height: '20px'
            }
        };
    }

    _valueChanged() {
        let str;
        if (typeof this.digits !== 'undefined') {
            str = parseFloat(this.value, 10).toFixed(this.digits);
        } else {
            str = String(this.value);
        }
        if (this.decimalSeparator !== '.') {
            str = str.replace('.', this.decimalSeparator);
        }
        this.formatedValue = str;
    }

}

window.customElements.define('feezal-element-basic-datetime', FeezalElementBasicDatetime);

export {FeezalElementBasicDatetime};